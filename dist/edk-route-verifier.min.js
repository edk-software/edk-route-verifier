!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=164)}([function(t,e,r){var n,o;!function(i,a){"use strict";void 0===(o="function"==typeof(n=function(){var t=function(){},e="undefined",r=["trace","debug","info","warn","error"];function n(t,e){var r=t[e];if("function"==typeof r.bind)return r.bind(t);try{return Function.prototype.bind.call(r,t)}catch(e){return function(){return Function.prototype.apply.apply(r,[t,arguments])}}}function o(e,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<e?t:this.methodFactory(i,e,n)}this.log=this.debug}function i(r,i,a){return function(r){"debug"===r&&(r="log");return typeof console!==e&&(void 0!==console[r]?n(console,r):void 0!==console.log?n(console,"log"):t)}(r)||function(t,r,n){return function(){typeof console!==e&&(o.call(this,r,n),this[t].apply(this,arguments))}}.apply(this,arguments)}function a(t,n,a){var u,s=this,c="loglevel";function f(){var t;if(typeof window!==e){try{t=window.localStorage[c]}catch(t){}if(typeof t===e)try{var r=window.document.cookie,n=r.indexOf(encodeURIComponent(c)+"=");-1!==n&&(t=/^([^;]+)/.exec(r.slice(n))[1])}catch(t){}return void 0===s.levels[t]&&(t=void 0),t}}t&&(c+=":"+t),s.name=t,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=a||i,s.getLevel=function(){return u},s.setLevel=function(n,i){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(u=n,!1!==i&&function(t){var n=(r[t]||"silent").toUpperCase();if(typeof window===e)return;try{return void(window.localStorage[c]=n)}catch(t){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(t){}}(n),o.call(s,n,t),typeof console===e&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(t){f()||s.setLevel(t,!1)},s.enableAll=function(t){s.setLevel(s.levels.TRACE,t)},s.disableAll=function(t){s.setLevel(s.levels.SILENT,t)};var l=f();null==l&&(l=null==n?"WARN":n),s.setLevel(l,!1)}var u=new a,s={};u.getLogger=function(t){if("string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=s[t];return e||(e=s[t]=new a(t,u.getLevel(),u.methodFactory)),e};var c=typeof window!==e?window.log:void 0;return u.noConflict=function(){return typeof window!==e&&window.log===u&&(window.log=c),u},u.getLoggers=function(){return s},u})?n.call(e,r,e,t):n)||(t.exports=o)}()},function(t,e){var r=Array.isArray;t.exports=r},function(t,e,r){var n=r(36),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();t.exports=i},function(t,e,r){var n=r(64),o=r(70);t.exports=function(t,e){var r=o(t,e);return n(r)?r:void 0}},function(t,e,r){var n=r(35),o=r(21);t.exports=function(t){return null!=t&&o(t.length)&&!n(t)}},function(t,e,r){var n=r(7),o=r(10),i="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||o(t)&&n(t)==i}},function(t,e){t.exports=function(t){return t}},function(t,e,r){var n=r(8),o=r(66),i=r(67),a="[object Null]",u="[object Undefined]",s=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?u:a:s&&s in Object(t)?o(t):i(t)}},function(t,e,r){var n=r(2).Symbol;t.exports=n},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,r){var n=r(122),o=r(125),i=r(6),a=r(1),u=r(135);t.exports=function(t){return"function"==typeof t?t:null==t?i:"object"==typeof t?a(t)?o(t[0],t[1]):n(t):u(t)}},function(t,e,r){var n=r(74),o=r(10),i=Object.prototype,a=i.hasOwnProperty,u=i.propertyIsEnumerable,s=n(function(){return arguments}())?n:function(t){return o(t)&&a.call(t,"callee")&&!u.call(t,"callee")};t.exports=s},function(t,e,r){var n=r(79),o=r(80),i=r(81),a=r(82),u=r(83);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},function(t,e,r){var n=r(25);t.exports=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},function(t,e,r){var n=r(3)(Object,"create");t.exports=n},function(t,e,r){var n=r(97);t.exports=function(t,e){var r=t.__data__;return n(e)?r["string"==typeof e?"string":"hash"]:r.map}},function(t,e,r){var n=r(115),o=r(32),i=r(4);t.exports=function(t){return i(t)?n(t):o(t)}},function(t,e,r){var n=r(5),o=1/0;t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}},function(t,e,r){"use strict";function n(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function o(t,e,r){return void 0===r&&(r={}),n({type:"Point",coordinates:t},e,r)}function i(t,e,r){void 0===r&&(r={});for(var o=0,i=t;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var u=0;u<a[a.length-1].length;u++)if(a[a.length-1][u]!==a[0][u])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function a(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function u(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function s(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function c(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function f(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function l(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t*n}function h(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t/n}function p(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return o(e).geometry;case"LineString":return a(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return c(e).geometry;case"MultiLineString":return s(e).geometry;case"MultiPolygon":return f(e).geometry;default:throw new Error(t+" is invalid")}},e.point=o,e.points=function(t,e,r){return void 0===r&&(r={}),u(t.map(function(t){return o(t,e)}),r)},e.polygon=i,e.polygons=function(t,e,r){return void 0===r&&(r={}),u(t.map(function(t){return i(t,e)}),r)},e.lineString=a,e.lineStrings=function(t,e,r){return void 0===r&&(r={}),u(t.map(function(t){return a(t,e)}),r)},e.featureCollection=u,e.multiLineString=s,e.multiPoint=c,e.multiPolygon=f,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,e||0);return Math.round(t*r)/r},e.radiansToLength=l,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return p(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=p,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return l(h(t,e),r)},e.convertArea=function(t,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[r];if(!o)throw new Error("invalid original units");var i=e.areaFactors[n];if(!i)throw new Error("invalid final units");return t/o*i},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")},e.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},e.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},e.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},e.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},e.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},e.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},e.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,r){var n=r(3)(r(2),"Map");t.exports=n},function(t,e){var r=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},function(t,e,r){(function(t){var n=r(2),o=r(75),i=e&&!e.nodeType&&e,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,u=a&&a.exports===i?n.Buffer:void 0,s=(u?u.isBuffer:void 0)||o;t.exports=s}).call(this,r(38)(t))},function(t,e,r){var n=r(76),o=r(39),i=r(77),a=i&&i.isTypedArray,u=a?o(a):n;t.exports=u},function(t,e,r){var n=r(78),o=r(10);t.exports=function t(e,r,i,a,u){return e===r||(null==e||null==r||!o(e)&&!o(r)?e!=e&&r!=r:n(e,r,i,a,t,u))}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,r){var n=r(89),o=r(96),i=r(98),a=r(99),u=r(100);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},function(t,e){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var o=typeof t;return!!(e=null==e?r:e)&&("number"==o||"symbol"!=o&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,r){var n=r(118),o=r(121)(n);t.exports=o},function(t,e,r){var n=r(1),o=r(5),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!o(t))||a.test(t)||!i.test(t)||null!=e&&t in Object(e)}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}},function(t,e,r){var n=r(32),o=r(34),i=r(12),a=r(1),u=r(4),s=r(22),c=r(33),f=r(23),l="[object Map]",h="[object Set]",p=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(u(t)&&(a(t)||"string"==typeof t||"function"==typeof t.splice||s(t)||f(t)||i(t)))return!t.length;var e=o(t);if(e==l||e==h)return!t.size;if(c(t))return!n(t).length;for(var r in t)if(p.call(t,r))return!1;return!0}},function(t,e,r){var n=r(33),o=r(61),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return o(t);var e=[];for(var r in Object(t))i.call(t,r)&&"constructor"!=r&&e.push(r);return e}},function(t,e){var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},function(t,e,r){var n=r(63),o=r(20),i=r(71),a=r(72),u=r(73),s=r(7),c=r(37),f=c(n),l=c(o),h=c(i),p=c(a),d=c(u),v=s;(n&&"[object DataView]"!=v(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=v(new o)||i&&"[object Promise]"!=v(i.resolve())||a&&"[object Set]"!=v(new a)||u&&"[object WeakMap]"!=v(new u))&&(v=function(t){var e=s(t),r="[object Object]"==e?t.constructor:void 0,n=r?c(r):"";if(n)switch(n){case f:return"[object DataView]";case l:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case d:return"[object WeakMap]"}return e}),t.exports=v},function(t,e,r){var n=r(7),o=r(9),i="[object AsyncFunction]",a="[object Function]",u="[object GeneratorFunction]",s="[object Proxy]";t.exports=function(t){if(!o(t))return!1;var e=n(t);return e==a||e==u||e==i||e==s}},function(t,e,r){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(this,r(65))},function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,r){var n=r(24);t.exports=function(t,e){return n(t,e)}},function(t,e,r){var n=r(13),o=r(84),i=r(85),a=r(86),u=r(87),s=r(88);function c(t){var e=this.__data__=new n(t);this.size=e.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=u,c.prototype.set=s,t.exports=c},function(t,e,r){var n=r(101),o=r(104),i=r(105),a=1,u=2;t.exports=function(t,e,r,s,c,f){var l=r&a,h=t.length,p=e.length;if(h!=p&&!(l&&p>h))return!1;var d=f.get(t);if(d&&f.get(e))return d==e;var v=-1,g=!0,y=r&u?new n:void 0;for(f.set(t,e),f.set(e,t);++v<h;){var m=t[v],b=e[v];if(s)var w=l?s(b,m,v,e,t,f):s(m,b,v,t,e,f);if(void 0!==w){if(w)continue;g=!1;break}if(y){if(!o(e,function(t,e){if(!i(y,e)&&(m===t||c(m,t,r,s,f)))return y.push(e)})){g=!1;break}}else if(m!==b&&!c(m,b,r,s,f)){g=!1;break}}return f.delete(t),f.delete(e),g}},function(t,e){t.exports=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i}},function(t,e){t.exports=function(t){return null===t}},function(t,e,r){var n=r(44),o=r(117),i=r(11),a=r(1);t.exports=function(t,e){return(a(t)?n:o)(t,i(e,3))}},function(t,e,r){var n=r(9);t.exports=function(t){return t==t&&!n(t)}},function(t,e){t.exports=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}}},function(t,e,r){var n=r(50),o=r(18);t.exports=function(t,e){for(var r=0,i=(e=n(e,t)).length;null!=t&&r<i;)t=t[o(e[r++])];return r&&r==i?t:void 0}},function(t,e,r){var n=r(1),o=r(29),i=r(127),a=r(130);t.exports=function(t,e){return n(t)?t:o(t,e)?[t]:i(a(t))}},function(t,e,r){var n=r(138)(r(139));t.exports=n},function(t,e,r){var n=r(144),o=r(28),i=r(145),a=r(1);t.exports=function(t,e){return(a(t)?n:o)(t,i(e))}},function(t,e,r){var n=r(30),o=r(11),i=r(54),a=r(1);t.exports=function(t,e){return(a(t)?n:i)(t,o(e,3))}},function(t,e,r){var n=r(28),o=r(4);t.exports=function(t,e){var r=-1,i=o(t)?Array(t.length):[];return n(t,function(t,n,o){i[++r]=e(t,n,o)}),i}},function(t,e,r){var n=r(146),o=r(147),i=r(6);t.exports=function(t){return t&&t.length?n(t,i,o):void 0}},function(t,e,r){var n=r(148),o=r(150),i=r(154),a=r(162),u=i(function(t,e){if(null==t)return[];var r=e.length;return r>1&&a(t,e[0],e[1])?e=[]:r>2&&a(e[0],e[1],e[2])&&(e=[e[0]]),o(t,n(e,1),[])});t.exports=u},function(t,e,r){(function(e){var n=function(){"use strict";var t,n=/\s*/g,o=/^\s*|\s*$/g,i=/\s+/;function a(t){if(!t||!t.length)return 0;for(var e=0,r=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e)|0;return r}function u(t,e){return t.getElementsByTagName(e)}function s(t,e){return t.getAttribute(e)}function c(t,e){return parseFloat(s(t,e))}function f(t,e){var r=u(t,e);return r.length?r[0]:null}function l(t){for(var e=0,r=[];e<t.length;e++)r[e]=parseFloat(t[e]);return r}function h(t){var e;return t&&(e=t).normalize&&e.normalize(),t&&t.textContent||""}function p(t,e){var r,n,o={};for(n=0;n<e.length;n++)(r=f(t,e[n]))&&(o[e[n]]=h(r));return o}function d(t,e){for(var r in e)t[r]=e[r]}function v(t){return l(t.replace(n,"").split(","))}function g(t){for(var e=t.replace(o,"").split(i),r=[],n=0;n<e.length;n++)r.push(v(e[n]));return r}function y(t){var e,r=[c(t,"lon"),c(t,"lat")],n=f(t,"ele"),o=f(t,"gpxtpx:hr")||f(t,"hr"),i=f(t,"time");return n&&(e=parseFloat(h(n)),isNaN(e)||r.push(e)),{coordinates:r,time:i?h(i):null,heartRate:o?parseFloat(h(o)):null}}function m(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}return"undefined"!=typeof XMLSerializer?t=new XMLSerializer:"object"!=typeof e||e.browser||(t=new(r(60).XMLSerializer)),{kml:function(t){for(var e={type:"FeatureCollection",features:[]},r={},n={},o={},i=["Polygon","LineString","Point","Track","gx:Track"],c=u(t,"Placemark"),p=u(t,"Style"),d=u(t,"StyleMap"),y=0;y<p.length;y++){var b=a(m(p[y])).toString(16);r["#"+s(p[y],"id")]=b,n[b]=p[y]}for(var w=0;w<d.length;w++){r["#"+s(d[w],"id")]=a(m(d[w])).toString(16);for(var x=u(d[w],"Pair"),E={},_=0;_<x.length;_++)E[h(f(x[_],"key"))]=h(f(x[_],"styleUrl"));o["#"+s(d[w],"id")]=E}for(var P=0;P<c.length;P++)e.features=e.features.concat(M(c[P]));function S(t){var e,r;return"#"===(t=t||"").substr(0,1)&&(t=t.substr(1)),6!==t.length&&3!==t.length||(e=t),8===t.length&&(r=parseInt(t.substr(0,2),16)/255,e="#"+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)),[e,isNaN(r)?void 0:r]}function j(t){var e=u(t,"coord"),r=[],n=[];0===e.length&&(e=u(t,"gx:coord"));for(var o=0;o<e.length;o++)r.push(l(h(e[o]).split(" ")));for(var i=u(t,"when"),a=0;a<i.length;a++)n.push(h(i[a]));return{coords:r,times:n}}function M(t){var e,a=function t(e){var r,n,o,a,s,c=[],l=[];if(f(e,"MultiGeometry"))return t(f(e,"MultiGeometry"));if(f(e,"MultiTrack"))return t(f(e,"MultiTrack"));if(f(e,"gx:MultiTrack"))return t(f(e,"gx:MultiTrack"));for(o=0;o<i.length;o++)if(n=u(e,i[o]))for(a=0;a<n.length;a++)if(r=n[a],"Point"===i[o])c.push({type:"Point",coordinates:v(h(f(r,"coordinates")))});else if("LineString"===i[o])c.push({type:"LineString",coordinates:g(h(f(r,"coordinates")))});else if("Polygon"===i[o]){var p=u(r,"LinearRing"),d=[];for(s=0;s<p.length;s++)d.push(g(h(f(p[s],"coordinates"))));c.push({type:"Polygon",coordinates:d})}else if("Track"===i[o]||"gx:Track"===i[o]){var y=j(r);c.push({type:"LineString",coordinates:y.coords}),y.times.length&&l.push(y.times)}return{geoms:c,coordTimes:l}}(t),c={},l=h(f(t,"name")),p=h(f(t,"styleUrl")),d=h(f(t,"description")),y=f(t,"TimeSpan"),m=f(t,"TimeStamp"),b=f(t,"ExtendedData"),w=f(t,"LineStyle"),x=f(t,"PolyStyle"),E=f(t,"visibility");if(!a.geoms.length)return[];if(l&&(c.name=l),p){"#"!==p[0]&&(p="#"+p),c.styleUrl=p,r[p]&&(c.styleHash=r[p]),o[p]&&(c.styleMapHash=o[p],c.styleHash=r[o[p].normal]);var _=n[c.styleHash];_&&(w||(w=f(_,"LineStyle")),x||(x=f(_,"PolyStyle")))}if(d&&(c.description=d),y){var P=h(f(y,"begin")),M=h(f(y,"end"));c.timespan={begin:P,end:M}}if(m&&(c.timestamp=h(f(m,"when"))),w){var O=S(h(f(w,"color"))),k=O[0],A=O[1],L=parseFloat(h(f(w,"width")));k&&(c.stroke=k),isNaN(A)||(c["stroke-opacity"]=A),isNaN(L)||(c["stroke-width"]=L)}if(x){var C=S(h(f(x,"color"))),T=C[0],F=C[1],R=h(f(x,"fill")),N=h(f(x,"outline"));T&&(c.fill=T),isNaN(F)||(c["fill-opacity"]=F),R&&(c["fill-opacity"]="1"===R?c["fill-opacity"]||1:0),N&&(c["stroke-opacity"]="1"===N?c["stroke-opacity"]||1:0)}if(b){var I=u(b,"Data"),B=u(b,"SimpleData");for(e=0;e<I.length;e++)c[I[e].getAttribute("name")]=h(f(I[e],"value"));for(e=0;e<B.length;e++)c[B[e].getAttribute("name")]=h(B[e])}E&&(c.visibility=h(E)),a.coordTimes.length&&(c.coordTimes=1===a.coordTimes.length?a.coordTimes[0]:a.coordTimes);var X={type:"Feature",geometry:1===a.geoms.length?a.geoms[0]:{type:"GeometryCollection",geometries:a.geoms},properties:c};return s(t,"id")&&(X.id=s(t,"id")),[X]}return e},gpx:function(t){var e,r,n=u(t,"trk"),o=u(t,"rte"),i=u(t,"wpt"),a={type:"FeatureCollection",features:[]};for(e=0;e<n.length;e++)(r=f(n[e]))&&a.features.push(r);for(e=0;e<o.length;e++)(r=l(o[e]))&&a.features.push(r);for(e=0;e<i.length;e++)a.features.push(h(i[e]));function c(t,e){var r=u(t,e),n=[],o=[],i=[],a=r.length;if(a<2)return{};for(var s=0;s<a;s++){var c=y(r[s]);n.push(c.coordinates),c.time&&o.push(c.time),c.heartRate&&i.push(c.heartRate)}return{line:n,times:o,heartRates:i}}function f(t){for(var e,r=u(t,"trkseg"),n=[],o=[],i=[],a=0;a<r.length;a++)(e=c(r[a],"trkpt"))&&(e.line&&n.push(e.line),e.times&&e.times.length&&o.push(e.times),e.heartRates&&e.heartRates.length&&i.push(e.heartRates));if(0!==n.length){var s=v(t);return o.length&&(s.coordTimes=1===n.length?o[0]:o),i.length&&(s.heartRates=1===n.length?i[0]:i),{type:"Feature",properties:s,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}}function l(t){var e=c(t,"rtept");if(e.line)return{type:"Feature",properties:v(t),geometry:{type:"LineString",coordinates:e.line}}}function h(t){var e=v(t);return d(e,p(t,["sym","type"])),{type:"Feature",properties:e,geometry:{type:"Point",coordinates:y(t).coordinates}}}function v(t){var e,r;e=p(t,["name","cmt","desc","time","keywords"]),(r=u(t,"link")).length&&(e.links=[]);for(var n,o=0;o<r.length;o++)d(n={href:s(r[o],"href")},p(r[o],["text","type"])),e.links.push(n);return e}return a}}}();t.exports=n}).call(this,r(59))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(163),o=r(19);e.default=function(t,e,r){void 0===r&&(r={});var i=n.getCoord(t),a=n.getCoord(e),u=o.degreesToRadians(a[1]-i[1]),s=o.degreesToRadians(a[0]-i[0]),c=o.degreesToRadians(i[1]),f=o.degreesToRadians(a[1]),l=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(c)*Math.cos(f);return o.radiansToLength(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),r.units)}},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],f=!1,l=-1;function h(){f&&s&&(f=!1,s.length?c=s.concat(c):l=-1,c.length&&p())}function p(){if(!f){var t=u(h);f=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,f=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new d(t,e)),1!==c.length||f||u(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){},function(t,e,r){var n=r(62)(Object.keys,Object);t.exports=n},function(t,e){t.exports=function(t,e){return function(r){return t(e(r))}}},function(t,e,r){var n=r(3)(r(2),"DataView");t.exports=n},function(t,e,r){var n=r(35),o=r(68),i=r(9),a=r(37),u=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,f=s.toString,l=c.hasOwnProperty,h=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(n(t)?h:u).test(a(t))}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){var n=r(8),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=n?n.toStringTag:void 0;t.exports=function(t){var e=i.call(t,u),r=t[u];try{t[u]=void 0;var n=!0}catch(t){}var o=a.call(t);return n&&(e?t[u]=r:delete t[u]),o}},function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e,r){var n,o=r(69),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!i&&i in t}},function(t,e,r){var n=r(2)["__core-js_shared__"];t.exports=n},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,r){var n=r(3)(r(2),"Promise");t.exports=n},function(t,e,r){var n=r(3)(r(2),"Set");t.exports=n},function(t,e,r){var n=r(3)(r(2),"WeakMap");t.exports=n},function(t,e,r){var n=r(7),o=r(10),i="[object Arguments]";t.exports=function(t){return o(t)&&n(t)==i}},function(t,e){t.exports=function(){return!1}},function(t,e,r){var n=r(7),o=r(21),i=r(10),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!a[n(t)]}},function(t,e,r){(function(t){var n=r(36),o=e&&!e.nodeType&&e,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o&&n.process,u=function(){try{var t=i&&i.require&&i.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=u}).call(this,r(38)(t))},function(t,e,r){var n=r(41),o=r(42),i=r(106),a=r(110),u=r(34),s=r(1),c=r(22),f=r(23),l=1,h="[object Arguments]",p="[object Array]",d="[object Object]",v=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,g,y,m){var b=s(t),w=s(e),x=b?p:u(t),E=w?p:u(e),_=(x=x==h?d:x)==d,P=(E=E==h?d:E)==d,S=x==E;if(S&&c(t)){if(!c(e))return!1;b=!0,_=!1}if(S&&!_)return m||(m=new n),b||f(t)?o(t,e,r,g,y,m):i(t,e,x,r,g,y,m);if(!(r&l)){var j=_&&v.call(t,"__wrapped__"),M=P&&v.call(e,"__wrapped__");if(j||M){var O=j?t.value():t,k=M?e.value():e;return m||(m=new n),y(O,k,r,g,m)}}return!!S&&(m||(m=new n),a(t,e,r,g,y,m))}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,r){var n=r(14),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=n(e,t);return!(r<0||(r==e.length-1?e.pop():o.call(e,r,1),--this.size,0))}},function(t,e,r){var n=r(14);t.exports=function(t){var e=this.__data__,r=n(e,t);return r<0?void 0:e[r][1]}},function(t,e,r){var n=r(14);t.exports=function(t){return n(this.__data__,t)>-1}},function(t,e,r){var n=r(14);t.exports=function(t,e){var r=this.__data__,o=n(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}},function(t,e,r){var n=r(13);t.exports=function(){this.__data__=new n,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,r){var n=r(13),o=r(20),i=r(26),a=200;t.exports=function(t,e){var r=this.__data__;if(r instanceof n){var u=r.__data__;if(!o||u.length<a-1)return u.push([t,e]),this.size=++r.size,this;r=this.__data__=new i(u)}return r.set(t,e),this.size=r.size,this}},function(t,e,r){var n=r(90),o=r(13),i=r(20);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},function(t,e,r){var n=r(91),o=r(92),i=r(93),a=r(94),u=r(95);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},function(t,e,r){var n=r(15);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,r){var n=r(15),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var r=e[t];return r===o?void 0:r}return i.call(e,t)?e[t]:void 0}},function(t,e,r){var n=r(15),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:o.call(e,t)}},function(t,e,r){var n=r(15),o="__lodash_hash_undefined__";t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=n&&void 0===e?o:e,this}},function(t,e,r){var n=r(16);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,r){var n=r(16);t.exports=function(t){return n(this,t).get(t)}},function(t,e,r){var n=r(16);t.exports=function(t){return n(this,t).has(t)}},function(t,e,r){var n=r(16);t.exports=function(t,e){var r=n(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}},function(t,e,r){var n=r(26),o=r(102),i=r(103);function a(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new n;++e<r;)this.add(t[e])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,t.exports=a},function(t,e){var r="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,r),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,r){var n=r(8),o=r(107),i=r(25),a=r(42),u=r(108),s=r(109),c=1,f=2,l="[object Boolean]",h="[object Date]",p="[object Error]",d="[object Map]",v="[object Number]",g="[object RegExp]",y="[object Set]",m="[object String]",b="[object Symbol]",w="[object ArrayBuffer]",x="[object DataView]",E=n?n.prototype:void 0,_=E?E.valueOf:void 0;t.exports=function(t,e,r,n,E,P,S){switch(r){case x:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case w:return!(t.byteLength!=e.byteLength||!P(new o(t),new o(e)));case l:case h:case v:return i(+t,+e);case p:return t.name==e.name&&t.message==e.message;case g:case m:return t==e+"";case d:var j=u;case y:var M=n&c;if(j||(j=s),t.size!=e.size&&!M)return!1;var O=S.get(t);if(O)return O==e;n|=f,S.set(t,e);var k=a(j(t),j(e),n,E,P,S);return S.delete(t),k;case b:if(_)return _.call(t)==_.call(e)}return!1}},function(t,e,r){var n=r(2).Uint8Array;t.exports=n},function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}},function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}},function(t,e,r){var n=r(111),o=1,i=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,a,u,s){var c=r&o,f=n(t),l=f.length;if(l!=n(e).length&&!c)return!1;for(var h=l;h--;){var p=f[h];if(!(c?p in e:i.call(e,p)))return!1}var d=s.get(t);if(d&&s.get(e))return d==e;var v=!0;s.set(t,e),s.set(e,t);for(var g=c;++h<l;){var y=t[p=f[h]],m=e[p];if(a)var b=c?a(m,y,p,e,t,s):a(y,m,p,t,e,s);if(!(void 0===b?y===m||u(y,m,r,a,s):b)){v=!1;break}g||(g="constructor"==p)}if(v&&!g){var w=t.constructor,x=e.constructor;w!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x)&&(v=!1)}return s.delete(t),s.delete(e),v}},function(t,e,r){var n=r(112),o=r(113),i=r(17);t.exports=function(t){return n(t,i,o)}},function(t,e,r){var n=r(43),o=r(1);t.exports=function(t,e,r){var i=e(t);return o(t)?i:n(i,r(t))}},function(t,e,r){var n=r(44),o=r(114),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,u=a?function(t){return null==t?[]:(t=Object(t),n(a(t),function(e){return i.call(t,e)}))}:o;t.exports=u},function(t,e){t.exports=function(){return[]}},function(t,e,r){var n=r(116),o=r(12),i=r(1),a=r(22),u=r(27),s=r(23),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=i(t),f=!r&&o(t),l=!r&&!f&&a(t),h=!r&&!f&&!l&&s(t),p=r||f||l||h,d=p?n(t.length,String):[],v=d.length;for(var g in t)!e&&!c.call(t,g)||p&&("length"==g||l&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||u(g,v))||d.push(g);return d}},function(t,e){t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},function(t,e,r){var n=r(28);t.exports=function(t,e){var r=[];return n(t,function(t,n,o){e(t,n,o)&&r.push(t)}),r}},function(t,e,r){var n=r(119),o=r(17);t.exports=function(t,e){return t&&n(t,e,o)}},function(t,e,r){var n=r(120)();t.exports=n},function(t,e){t.exports=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var s=a[t?u:++o];if(!1===r(i[s],s,i))break}return e}}},function(t,e,r){var n=r(4);t.exports=function(t,e){return function(r,o){if(null==r)return r;if(!n(r))return t(r,o);for(var i=r.length,a=e?i:-1,u=Object(r);(e?a--:++a<i)&&!1!==o(u[a],a,u););return r}}},function(t,e,r){var n=r(123),o=r(124),i=r(48);t.exports=function(t){var e=o(t);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(r){return r===t||n(r,t,e)}}},function(t,e,r){var n=r(41),o=r(24),i=1,a=2;t.exports=function(t,e,r,u){var s=r.length,c=s,f=!u;if(null==t)return!c;for(t=Object(t);s--;){var l=r[s];if(f&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<c;){var h=(l=r[s])[0],p=t[h],d=l[1];if(f&&l[2]){if(void 0===p&&!(h in t))return!1}else{var v=new n;if(u)var g=u(p,d,h,t,e,v);if(!(void 0===g?o(d,p,i|a,u,v):g))return!1}}return!0}},function(t,e,r){var n=r(47),o=r(17);t.exports=function(t){for(var e=o(t),r=e.length;r--;){var i=e[r],a=t[i];e[r]=[i,a,n(a)]}return e}},function(t,e,r){var n=r(24),o=r(126),i=r(132),a=r(29),u=r(47),s=r(48),c=r(18),f=1,l=2;t.exports=function(t,e){return a(t)&&u(e)?s(c(t),e):function(r){var a=o(r,t);return void 0===a&&a===e?i(r,t):n(e,a,f|l)}}},function(t,e,r){var n=r(49);t.exports=function(t,e,r){var o=null==t?void 0:n(t,e);return void 0===o?r:o}},function(t,e,r){var n=r(128),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,function(t,r,n,o){e.push(n?o.replace(i,"$1"):r||t)}),e});t.exports=a},function(t,e,r){var n=r(129),o=500;t.exports=function(t){var e=n(t,function(t){return r.size===o&&r.clear(),t}),r=e.cache;return e}},function(t,e,r){var n=r(26),o="Expected a function";function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(o);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(i.Cache||n),r}i.Cache=n,t.exports=i},function(t,e,r){var n=r(131);t.exports=function(t){return null==t?"":n(t)}},function(t,e,r){var n=r(8),o=r(30),i=r(1),a=r(5),u=1/0,s=n?n.prototype:void 0,c=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return o(e,t)+"";if(a(e))return c?c.call(e):"";var r=e+"";return"0"==r&&1/e==-u?"-0":r}},function(t,e,r){var n=r(133),o=r(134);t.exports=function(t,e){return null!=t&&o(t,e,n)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,r){var n=r(50),o=r(12),i=r(1),a=r(27),u=r(21),s=r(18);t.exports=function(t,e,r){for(var c=-1,f=(e=n(e,t)).length,l=!1;++c<f;){var h=s(e[c]);if(!(l=null!=t&&r(t,h)))break;t=t[h]}return l||++c!=f?l:!!(f=null==t?0:t.length)&&u(f)&&a(h,f)&&(i(t)||o(t))}},function(t,e,r){var n=r(136),o=r(137),i=r(29),a=r(18);t.exports=function(t){return i(t)?n(a(t)):o(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,r){var n=r(49);t.exports=function(t){return function(e){return n(e,t)}}},function(t,e,r){var n=r(11),o=r(4),i=r(17);t.exports=function(t){return function(e,r,a){var u=Object(e);if(!o(e)){var s=n(r,3);e=i(e),r=function(t){return s(u[t],t,u)}}var c=t(e,r,a);return c>-1?u[s?e[c]:c]:void 0}}},function(t,e,r){var n=r(140),o=r(11),i=r(141),a=Math.max;t.exports=function(t,e,r){var u=null==t?0:t.length;if(!u)return-1;var s=null==r?0:i(r);return s<0&&(s=a(u+s,0)),n(t,o(e,3),s)}},function(t,e){t.exports=function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}},function(t,e,r){var n=r(142);t.exports=function(t){var e=n(t),r=e%1;return e==e?r?e-r:e:0}},function(t,e,r){var n=r(143),o=1/0,i=1.7976931348623157e308;t.exports=function(t){return t?(t=n(t))===o||t===-o?(t<0?-1:1)*i:t==t?t:0:0===t?t:0}},function(t,e,r){var n=r(9),o=r(5),i=NaN,a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return i;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var r=s.test(t);return r||c.test(t)?f(t.slice(2),r?2:8):u.test(t)?i:+t}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}},function(t,e,r){var n=r(6);t.exports=function(t){return"function"==typeof t?t:n}},function(t,e,r){var n=r(5);t.exports=function(t,e,r){for(var o=-1,i=t.length;++o<i;){var a=t[o],u=e(a);if(null!=u&&(void 0===s?u==u&&!n(u):r(u,s)))var s=u,c=a}return c}},function(t,e){t.exports=function(t,e){return t<e}},function(t,e,r){var n=r(43),o=r(149);t.exports=function t(e,r,i,a,u){var s=-1,c=e.length;for(i||(i=o),u||(u=[]);++s<c;){var f=e[s];r>0&&i(f)?r>1?t(f,r-1,i,a,u):n(u,f):a||(u[u.length]=f)}return u}},function(t,e,r){var n=r(8),o=r(12),i=r(1),a=n?n.isConcatSpreadable:void 0;t.exports=function(t){return i(t)||o(t)||!!(a&&t&&t[a])}},function(t,e,r){var n=r(30),o=r(11),i=r(54),a=r(151),u=r(39),s=r(152),c=r(6);t.exports=function(t,e,r){var f=-1;e=n(e.length?e:[c],u(o));var l=i(t,function(t,r,o){return{criteria:n(e,function(e){return e(t)}),index:++f,value:t}});return a(l,function(t,e){return s(t,e,r)})}},function(t,e){t.exports=function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}},function(t,e,r){var n=r(153);t.exports=function(t,e,r){for(var o=-1,i=t.criteria,a=e.criteria,u=i.length,s=r.length;++o<u;){var c=n(i[o],a[o]);if(c)return o>=s?c:c*("desc"==r[o]?-1:1)}return t.index-e.index}},function(t,e,r){var n=r(5);t.exports=function(t,e){if(t!==e){var r=void 0!==t,o=null===t,i=t==t,a=n(t),u=void 0!==e,s=null===e,c=e==e,f=n(e);if(!s&&!f&&!a&&t>e||a&&u&&c&&!s&&!f||o&&u&&c||!r&&c||!i)return 1;if(!o&&!a&&!f&&t<e||f&&r&&i&&!o&&!a||s&&r&&i||!u&&i||!c)return-1}return 0}},function(t,e,r){var n=r(6),o=r(155),i=r(157);t.exports=function(t,e){return i(o(t,e,n),t+"")}},function(t,e,r){var n=r(156),o=Math.max;t.exports=function(t,e,r){return e=o(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,u=o(i.length-e,0),s=Array(u);++a<u;)s[a]=i[e+a];a=-1;for(var c=Array(e+1);++a<e;)c[a]=i[a];return c[e]=r(s),n(t,this,c)}}},function(t,e){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},function(t,e,r){var n=r(158),o=r(161)(n);t.exports=o},function(t,e,r){var n=r(159),o=r(160),i=r(6),a=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:i;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e,r){var n=r(3),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e){var r=800,n=16,o=Date.now;t.exports=function(t){var e=0,i=0;return function(){var a=o(),u=n-(a-i);if(i=a,u>0){if(++e>=r)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,r){var n=r(25),o=r(4),i=r(27),a=r(9);t.exports=function(t,e,r){if(!a(r))return!1;var u=typeof e;return!!("number"==u?o(r)&&i(e,r.length):"string"==u&&e in r)&&n(r[e],t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(19);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=t.features;n<o.length;n++){var i=o[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+i.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},function(t,e,r){"use strict";r.r(e);var n=r(0),o=r.n(n),i=r(57),a=r.n(i);function u(t,e,r){if(!c(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&f(n),o&&l(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function s(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function c(t){return!!t&&t.constructor===Object}function f(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!s(t))throw new Error("bbox must only contain numbers")})}function l(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function h(t,e){var r,n,o,i,a,u,s,c,f,l,h=0,p="FeatureCollection"===t.type,d="Feature"===t.type,v=p?t.features.length:1;for(r=0;r<v;r++){for(u=p?t.features[r].geometry:d?t.geometry:t,c=p?t.features[r].properties:d?t.properties:{},f=p?t.features[r].bbox:d?t.bbox:void 0,l=p?t.features[r].id:d?t.id:void 0,a=(s=!!u&&"GeometryCollection"===u.type)?u.geometries.length:1,o=0;o<a;o++)if(null!==(i=s?u.geometries[o]:u))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,c,f,l))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],h,c,f,l))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,c,f,l))return!1;h++}}function p(t,e){h(t,function(t,r,n,o,i){var a,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(u(t,n,{bbox:o,id:i}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var f=t.coordinates[c];if(!1===e(u({type:a,coordinates:f},n),r,c))return!1}})}function d(t,e){if(!g(e=e||{}))throw new Error("options is invalid");var r=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&y(r),n&&m(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=t,o}function v(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function g(t){return!!t&&t.constructor===Object}function y(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!v(t))throw new Error("bbox must only contain numbers")})}function m(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var b=function(t){if(!t)throw new Error("geojson is required");var e=[];return p(t,function(t){e.push(t)}),d(e)},w=r(31),x=r.n(w),E=r(40),_=r.n(E),P=r(45),S=r.n(P),j=r(46),M=r.n(j),O=r(51),k=r.n(O),A=r(52),L=r.n(A),C=r(53),T=r.n(C),F=(r(55),r(56)),R=r.n(F),N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},I=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var B=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return I(t,null,[{key:"getGeoJSON",value:function(t){for(var e=t.getElementsByTagName("ExtendedData"),r=e.length-1;r>=0;r--)e[r].parentNode.removeChild(e[r]);o.a.log("KML (no ExtendedData):",t);var n=a.a.kml(t);return n=b(n),o.a.log("GeoJSON (flatten): ",n),n}},{key:"getNumberOfFeatures",value:function(t,e){return M.a(e.features,function(e){return _.a(e.geometry.type,t)}).length}},{key:"getLineString",value:function(t){return k.a(t.features,function(t){return _.a(t.geometry.type,"LineString")})}},{key:"reverseLineString",value:function(t){var e=N({},t);return e.geometry.coordinates=t.geometry.coordinates.reverse(),e}},{key:"getPoints",value:function(t){return M.a(t.features,function(t){return _.a(t.geometry.type,"Point")})}},{key:"getRoute",value:function(t){return o.a.debug("Fetching route from:",t),$.ajax(t)}},{key:"getGoogleMapsPath",value:function(t){return T.a(t.geometry.coordinates,function(t){return new google.maps.LatLng(t[1],t[0])})}},{key:"getPathElevations",value:function(t,e){if(e&&3===t.geometry.coordinates[0].length){o.a.debug("Getting path elevations from line string...");var r=T.a(t.geometry.coordinates,function(t){return{elevation:t[2]}});return o.a.debug("Elevations:",r),new Promise(function(t,e){t(r)})}var n=this.getGoogleMapsPath(t);if(o.a.debug("Number of LatLng objects:",n.length),n.length>1024){for(var i=[],a=parseFloat(n.length/1024),u=0;u<n.length;u+=a)i.push(n[Math.floor(u)]);n=i,o.a.debug("Number of LatLng objects after optimization:",n.length)}return new Promise(function(t,e){(new google.maps.ElevationService).getElevationAlongPath({path:n,samples:512},function(r,n){n===google.maps.ElevationStatus.OK?t(r):e(n)})})}},{key:"getRouteParameters",value:function(t){return new Promise(function(e,r){$.ajax(t).done(function(t){o.a.debug("Route parameters:",t),1===t.success?e(t):r("Server side error: "+t.error)}).fail(function(t,e){r(e)})})}},{key:"approveRoute",value:function(t){return new Promise(function(e,r){$.ajax(t).done(function(t){e({success:!0})}).fail(function(t,e){r(e)})})}}]),t}(),X=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var q=function(t){for(var e=0,r=1;r<t.length;r++){var n=t[r].elevation-t[r-1].elevation;e+=n>0?n:0}return Number(e)},G=function(t){for(var e=0,r=1;r<t.length;r++){var n=t[r-1].elevation-t[r].elevation;e+=n>0?n:0}return Number(e)},z=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gain=q(e),this.loss=G(e),this.totalChange=this.loss+this.gain,this.data=e}return X(t,[{key:"enrichData",value:function(t){for(var e=[],r=t/this.data.length,n=0;n<this.data.length;n++)e.push({elevation:this.data[n].elevation,distance:n*r});this.data=e}}]),t}();function Y(t){if(!t)throw new Error("obj is required");var e=function(t){if(!t)throw new Error("obj is required");var e;t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates);if(e)return function t(e){if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")}(e),e;throw new Error("No valid coordinates")}(t);if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return e;throw new Error("Coordinate is not a valid Point")}function D(t,e,r){if(!0===("object"==typeof r?r.final:r))return function(t,e){var r=D(e,t);return r=(r+180)%360}(t,e);var n=Math.PI/180,o=180/Math.PI,i=Y(t),a=Y(e),u=n*i[0],s=n*a[0],c=n*i[1],f=n*a[1],l=Math.sin(s-u)*Math.cos(f),h=Math.cos(c)*Math.sin(f)-Math.sin(c)*Math.cos(f)*Math.cos(s-u);return o*Math.atan2(l,h)}var U=D;function V(t){if(!t)throw new Error("obj is required");var e=J(t);if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return e;throw new Error("Coordinate is not a valid Point")}function J(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return function t(e){if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")}(e),e;throw new Error("No valid coordinates")}function W(t,e,r,n){if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");if(r&&4!==r.length)throw new Error("bbox must be an Array of 4 numbers");if(n&&-1===["string","number"].indexOf(typeof n))throw new Error("id must be a number or a string");var o={type:"Feature"};return n&&(o.id=n),r&&(o.bbox=r),o.properties=e||{},o.geometry=t,o}function H(t,e,r,n){if(!t)throw new Error("No coordinates passed");if(void 0===t.length)throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");if(!tt(t[0])||!tt(t[1]))throw new Error("Coordinates must contain numbers");return W({type:"Point",coordinates:t},e,r,n)}function K(t,e,r,n){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");if(!tt(t[0][1])||!tt(t[0][1]))throw new Error("Coordinates must contain numbers");return W({type:"LineString",coordinates:t},e,r,n)}var Q={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65};function Z(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var r=Q[e||"kilometers"];if(!r)throw new Error(e+" units is invalid");return t*r}function tt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}var et=function(t,e,r){var n="object"==typeof r?r.units:r,o=Math.PI/180,i=V(t),a=V(e),u=o*(a[1]-i[1]),s=o*(a[0]-i[0]),c=o*i[1],f=o*a[1],l=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(c)*Math.cos(f);return Z(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),n)};function rt(t){if(!t)throw new Error("obj is required");var e=function(t){if(!t)throw new Error("obj is required");var e;t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates);if(e)return function t(e){if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")}(e),e;throw new Error("No valid coordinates")}(t);if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return e;throw new Error("Coordinate is not a valid Point")}function nt(t,e,r,n){if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");if(r&&4!==r.length)throw new Error("bbox must be an Array of 4 numbers");if(n&&-1===["string","number"].indexOf(typeof n))throw new Error("id must be a number or a string");var o={type:"Feature"};return n&&(o.id=n),r&&(o.bbox=r),o.properties=e||{},o.geometry=t,o}function ot(t,e,r,n){if(!t)throw new Error("No coordinates passed");if(void 0===t.length)throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");if(!ut(t[0])||!ut(t[1]))throw new Error("Coordinates must contain numbers");return nt({type:"Point",coordinates:t},e,r,n)}var it={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65};function at(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var r=it[e||"kilometers"];if(!r)throw new Error(e+" units is invalid");return t/r}function ut(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}var st=function(t,e,r,n){var o="object"==typeof n?n.units:n,i=Math.PI/180,a=180/Math.PI,u=rt(t),s=i*u[0],c=i*u[1],f=i*r,l=at(e,o),h=Math.asin(Math.sin(c)*Math.cos(l)+Math.cos(c)*Math.sin(l)*Math.cos(f));return ot([a*(s+Math.atan2(Math.sin(f)*Math.sin(l)*Math.cos(c),Math.cos(l)-Math.sin(c)*Math.sin(h))),a*h])};function ct(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function ft(t,e){return t<e?-1:t>e?1:0}var lt=function(t,e,r,n,o){!function t(e,r,n,o,i){for(;o>n;){if(o-n>600){var a=o-n+1,u=r-n+1,s=Math.log(a),c=.5*Math.exp(2*s/3),f=.5*Math.sqrt(s*c*(a-c)/a)*(u-a/2<0?-1:1),l=Math.max(n,Math.floor(r-u*c/a+f)),h=Math.min(o,Math.floor(r+(a-u)*c/a+f));t(e,r,l,h,i)}var p=e[r],d=n,v=o;for(ct(e,n,r),i(e[o],p)>0&&ct(e,n,o);d<v;){for(ct(e,d,v),d++,v--;i(e[d],p)<0;)d++;for(;i(e[v],p)>0;)v--}0===i(e[n],p)?ct(e,n,v):ct(e,++v,o),v<=r&&(n=v+1),r<=v&&(o=v-1)}}(t,e,r||0,n||t.length-1,o||ft)};function ht(t,e){if(!(this instanceof ht))return new ht(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function pt(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function dt(t,e){vt(t,0,t.children.length,e,t)}function vt(t,e,r,n,o){o||(o=_t(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i,a=e;a<r;a++)i=t.children[a],gt(o,t.leaf?n(i):i);return o}function gt(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function yt(t,e){return t.minX-e.minX}function mt(t,e){return t.minY-e.minY}function bt(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function wt(t){return t.maxX-t.minX+(t.maxY-t.minY)}function xt(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Et(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function _t(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Pt(t,e,r,n,o){for(var i,a=[e,r];a.length;)(r=a.pop())-(e=a.pop())<=n||(i=e+Math.ceil((r-e)/n/2)*n,lt(t,i,e,r,o),a.push(e,i,i,r))}ht.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],n=this.toBBox;if(!Et(t,e))return r;for(var o,i,a,u,s=[];e;){for(o=0,i=e.children.length;o<i;o++)a=e.children[o],Et(t,u=e.leaf?n(a):a)&&(e.leaf?r.push(a):xt(t,u)?this._all(a,r):s.push(a));e=s.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!Et(t,e))return!1;for(var n,o,i,a,u=[];e;){for(n=0,o=e.children.length;n<o;n++)if(i=e.children[n],Et(t,a=e.leaf?r(i):i)){if(e.leaf||xt(t,a))return!0;u.push(i)}e=u.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var o=this.data;this.data=n,n=o}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=_t([]),this},remove:function(t,e){if(!t)return this;for(var r,n,o,i,a=this.data,u=this.toBBox(t),s=[],c=[];a||s.length;){if(a||(a=s.pop(),n=s[s.length-1],r=c.pop(),i=!0),a.leaf&&-1!==(o=pt(t,a.children,e)))return a.children.splice(o,1),s.push(a),this._condense(s),this;i||a.leaf||!xt(a,u)?n?(r++,a=n.children[r],i=!1):a=null:(s.push(a),c.push(r),r=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:yt,compareMinY:mt,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var o,i=r-e+1,a=this._maxEntries;if(i<=a)return dt(o=_t(t.slice(e,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1))),(o=_t([])).leaf=!1,o.height=n;var u,s,c,f,l=Math.ceil(i/a),h=l*Math.ceil(Math.sqrt(a));for(Pt(t,e,r,h,this.compareMinX),u=e;u<=r;u+=h)for(Pt(t,u,c=Math.min(u+h-1,r),l,this.compareMinY),s=u;s<=c;s+=l)f=Math.min(s+l-1,c),o.children.push(this._build(t,s,f,n-1));return dt(o,this.toBBox),o},_chooseSubtree:function(t,e,r,n){for(var o,i,a,u,s,c,f,l,h,p;n.push(e),!e.leaf&&n.length-1!==r;){for(f=l=1/0,o=0,i=e.children.length;o<i;o++)s=bt(a=e.children[o]),h=t,p=a,(c=(Math.max(p.maxX,h.maxX)-Math.min(p.minX,h.minX))*(Math.max(p.maxY,h.maxY)-Math.min(p.minY,h.minY))-s)<l?(l=c,f=s<f?s:f,u=a):c===l&&s<f&&(f=s,u=a);e=u||e.children[0]}return e},_insert:function(t,e,r){var n=this.toBBox,o=r?t:n(t),i=[],a=this._chooseSubtree(o,this.data,e,i);for(a.children.push(t),gt(a,o);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(o,i,e)},_split:function(t,e){var r=t[e],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var i=this._chooseSplitIndex(r,o,n),a=_t(r.children.splice(i,r.children.length-i));a.height=r.height,a.leaf=r.leaf,dt(r,this.toBBox),dt(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},_splitRoot:function(t,e){this.data=_t([t,e]),this.data.height=t.height+1,this.data.leaf=!1,dt(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var n,o,i,a,u,s,c,f,l,h,p,d,v,g;for(s=c=1/0,n=e;n<=r-e;n++)o=vt(t,0,n,this.toBBox),i=vt(t,n,r,this.toBBox),l=o,h=i,p=void 0,d=void 0,v=void 0,g=void 0,p=Math.max(l.minX,h.minX),d=Math.max(l.minY,h.minY),v=Math.min(l.maxX,h.maxX),g=Math.min(l.maxY,h.maxY),a=Math.max(0,v-p)*Math.max(0,g-d),u=bt(o)+bt(i),a<s?(s=a,f=n,c=u<c?u:c):a===s&&u<c&&(c=u,f=n);return f},_chooseSplitAxis:function(t,e,r){var n=t.leaf?this.compareMinX:yt,o=t.leaf?this.compareMinY:mt;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,o)&&t.children.sort(n)},_allDistMargin:function(t,e,r,n){t.children.sort(n);var o,i,a=this.toBBox,u=vt(t,0,e,a),s=vt(t,r-e,r,a),c=wt(u)+wt(s);for(o=e;o<r-e;o++)i=t.children[o],gt(u,t.leaf?a(i):i),c+=wt(u);for(o=r-e-1;o>=e;o--)i=t.children[o],gt(s,t.leaf?a(i):i),c+=wt(s);return c},_adjustParentBBoxes:function(t,e,r){for(var n=r;n>=0;n--)gt(e[n],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():dt(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var St=ht;function jt(t,e,r){if(null!==t){var n,o,i,a,u,s,c,f,l,h,p=0,d=0,v=t.type,g="FeatureCollection"===v,y="Feature"===v,m=g?t.features.length:1;for(n=0;n<m;n++)for(c=(h=!!(l=g?t.features[n].geometry:y?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1,o=0;o<c;o++){var b=0;if(null!==(s=h?l.geometries[o]:l)){f=s.coordinates;var w=s.type;switch(p=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":e(f,d,n,b),d++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<f.length;i++)e(f[i],d,n,b),d++,"MultiPoint"===w&&b++;"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<f.length;i++){for(a=0;a<f[i].length-p;a++)e(f[i][a],d,n,b),d++;"MultiLineString"===w&&b++}"Polygon"===w&&b++;break;case"MultiPolygon":for(i=0;i<f.length;i++){for(a=0;a<f[i].length;a++)for(u=0;u<f[i][a].length-p;u++)e(f[i][a][u],d,n,b),d++;b++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)jt(s.geometries[i],e,r);break;default:throw new Error("Unknown Geometry Type")}}}}}function Mt(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)e(t.features[r],r)}function Ot(t,e){var r,n,o,i,a,u,s,c,f=0,l="FeatureCollection"===t.type,h="Feature"===t.type,p=l?t.features.length:1;for(r=0;r<p;r++){for(u=l?t.features[r].geometry:h?t.geometry:t,c=l?t.features[r].properties:h?t.properties:{},a=(s=!!u&&"GeometryCollection"===u.type)?u.geometries.length:1,o=0;o<a;o++)if(null!==(i=s?u.geometries[o]:u))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(i,f,c);break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)e(i.geometries[n],f,c);break;default:throw new Error("Unknown Geometry Type")}else e(null,f,c);f++}}function kt(t,e){Ot(t,function(t,r,n){var o,i=null===t?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return void e(At(t,n),r,0)}switch(i){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}t.coordinates.forEach(function(t,i){e(At({type:o,coordinates:t},n),r,i)})})}function At(t,e){if(void 0===t)throw new Error("No geometry passed");return{type:"Feature",properties:e||{},geometry:t}}function Lt(t){var e=[t[0],t[1]],r=[t[0],t[3]],n=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],n,r,e]]}}}function Ct(t){var e=[1/0,1/0,-1/0,-1/0];return jt(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}var Tt=function(t){var e=St(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Lt(e)).bbox=e}else t.bbox=t.bbox?t.bbox:Ct(t);return St.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach(function(t){var r=Lt(t);r.bbox=t,e.push(r)}):Mt(t,function(t){t.bbox=t.bbox?t.bbox:Ct(t),e.push(t)}),St.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Lt(e)).bbox=e}return St.prototype.remove.call(this,t)},e.clear=function(){return St.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:St.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return St.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:St.prototype.all.call(this)}},e.toJSON=function(){return St.prototype.toJSON.call(this)},e.fromJSON=function(t){return St.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:Ct(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e};function Ft(t,e,r){if(!Bt(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&Xt(n),o&&qt(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function Rt(t,e,r){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!It(t[0][1])||!It(t[0][1]))throw new Error("coordinates must contain numbers");return Ft({type:"LineString",coordinates:t},e,r)}function Nt(t,e){if(!Bt(e=e||{}))throw new Error("options is invalid");var r=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&Xt(r),n&&qt(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=t,o}function It(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Bt(t){return!!t&&t.constructor===Object}function Xt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!It(t))throw new Error("bbox must only contain numbers")})}function qt(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Gt(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function zt(t,e){var r,n,o,i,a,u,s,c,f,l,h=0,p="FeatureCollection"===t.type,d="Feature"===t.type,v=p?t.features.length:1;for(r=0;r<v;r++){for(u=p?t.features[r].geometry:d?t.geometry:t,c=p?t.features[r].properties:d?t.properties:{},f=p?t.features[r].bbox:d?t.bbox:void 0,l=p?t.features[r].id:d?t.id:void 0,a=(s=!!u&&"GeometryCollection"===u.type)?u.geometries.length:1,o=0;o<a;o++)if(null!==(i=s?u.geometries[o]:u))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,c,f,l))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],h,c,f,l))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,c,f,l))return!1;h++}}function Yt(t,e){zt(t,function(t,r,n,o,i){var a,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Ft(t,n,{bbox:o,id:i}),r,0)&&void 0}switch(u){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var s=0;s<t.coordinates.length;s++){var c=t.coordinates[s];if(!1===e(Ft({type:a,coordinates:c},n),r,s))return!1}})}var Dt=function(t){if(!t)throw new Error("geojson is required");var e=[];return Yt(t,function(t){!function(t,e){var r=[],n=t.geometry;switch(n.type){case"Polygon":r=Gt(n);break;case"LineString":r=[Gt(n)]}r.forEach(function(r){var n=function(t,e){var r=[];return t.reduce(function(t,n){var o,i,a,u,s,c,f=Rt([t,n],e);return f.bbox=(i=n,a=(o=t)[0],u=o[1],s=i[0],c=i[1],[a<s?a:s,u<c?u:c,a>s?a:s,u>c?u:c]),r.push(f),n}),r}(r,t.properties);n.forEach(function(t){t.id=e.length,e.push(t)})})}(t,e)}),Nt(e)};function $t(t,e,r){if(!Wt(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&Ht(n),o&&Kt(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function Ut(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Jt(t[0])||!Jt(t[1]))throw new Error("coordinates must contain numbers");return $t({type:"Point",coordinates:t},e,r)}function Vt(t,e){if(!Wt(e=e||{}))throw new Error("options is invalid");var r=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&Ht(r),n&&Kt(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=t,o}function Jt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Wt(t){return!!t&&t.constructor===Object}function Ht(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!Jt(t))throw new Error("bbox must only contain numbers")})}function Kt(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Qt(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Zt(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function te(t,e){var r=Qt(t),n=Qt(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=r[0][0],i=r[0][1],a=r[1][0],u=r[1][1],s=n[0][0],c=n[0][1],f=n[1][0],l=n[1][1],h=(l-c)*(a-o)-(f-s)*(u-i),p=(f-s)*(i-c)-(l-c)*(o-s),d=(a-o)*(i-c)-(u-i)*(o-s);if(0===h)return null;var v=p/h,g=d/h;return v>=0&&v<=1&&g>=0&&g<=1?Ut([o+v*(a-o),i+v*(u-i)]):null}var ee=function(t,e){var r={},n=[];if("LineString"===t.type&&(t=$t(t)),"LineString"===e.type&&(e=$t(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var o=te(t,e);return o&&n.push(o),Vt(n)}var i=Tt();return i.load(Dt(e)),Zt(Dt(t),function(t){Zt(i.search(t),function(e){var o=te(t,e);if(o){var i=Qt(o).join(",");r[i]||(r[i]=!0,n.push(o))}})}),Vt(n)};var re=function(t,e,r){var n="object"==typeof r?r.units:r,o=t.geometry?t.geometry.type:t.type;if("LineString"!==o&&"MultiLineString"!==o)throw new Error("lines must be LineString or MultiLineString");var i=H([1/0,1/0],{dist:1/0}),a=0;return kt(t,function(t){for(var r=J(t),o=0;o<r.length-1;o++){var u=H(r[o]);u.properties.dist=et(e,u,n);var s=H(r[o+1]);s.properties.dist=et(e,s,n);var c=et(u,s,n),f=Math.max(u.properties.dist,s.properties.dist),l=U(u,s),h=st(e,f,l+90,n),p=st(e,f,l-90,n),d=ee(K([h.geometry.coordinates,p.geometry.coordinates]),K([u.geometry.coordinates,s.geometry.coordinates])),v=null;d.features.length>0&&((v=d.features[0]).properties.dist=et(e,v,n),v.properties.location=a+et(u,v,n)),u.properties.dist<i.properties.dist&&((i=u).properties.index=o,i.properties.location=a),s.properties.dist<i.properties.dist&&((i=s).properties.index=o+1,i.properties.location=a+c),v&&v.properties.dist<i.properties.dist&&((i=v).properties.index=o),a+=c}}),i},ne=r(58),oe=r.n(ne),ie=r(19),ae=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var ue={pointOnLine:re,distance:oe.a,point:ie.point},se=0,ce=1,fe=14,le=15,he=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.points=e,this.path=r,this.pathReversed=!1,this.pathCircular=!1,this.pathStart=ue.point(this.path.geometry.coordinates[0]),this.pathEnd=ue.point(this.path.geometry.coordinates[this.path.geometry.coordinates.length-1]),this._sortPoints(),this._addIndexes(),this._updateCircularity(),this.pathCircular||this._updateDirection()}return ae(t,[{key:"_sortPoints",value:function(){var t=this.path,e=T.a(this.points,function(e){return e.properties.nearestOnLine=ue.pointOnLine(t,e,"meters"),e}),r=R.a(e,function(t){return t.properties.nearestOnLine.properties.location});this.points=r}},{key:"_addIndexes",value:function(){this.points=T.a(this.points,function(t){var e=function(t){var e=/^(wstp|wprowadzenie|pocztek|start)$/gi,r=/^(zakoczenie|koniec|podsumowanie)$/gi,n=/^(I|II|III|IV|V|VI|VII|VIII|IX|X|XI|XII|XIII|XIV)$/g,i=/^\d+$/g,a={I:1,II:2,III:3,IV:4,V:5,VI:6,VII:7,VIII:8,IX:9,X:10,XI:11,XII:12,XIII:13,XIV:14},u=null;if(o.a.debug("Checking station index for string: "+t),!t)return u;var s=t.trim().split(/[ ,\._\-:;]+/);return L.a(s,function(t){var o=t.match(n);if(!S.a(o))return u=a[o[0]],!1;if(o=t.match(i),!S.a(o)){var s=parseInt(o[0]);return!(s>=ce&&s<=fe&&(u=s,1))}return o=t.match(e),S.a(o)?(o=t.match(r),S.a(o)?void 0:(u=le,!1)):(u=se,!1)}),u}(t.properties.name);return t.properties.index=e,t})}},{key:"_updateDirection",value:function(){var t=M.a(this.points,function(t){return t.properties.index===se}),e=M.a(this.points,function(t){return t.properties.index===le}),r={units:"kilometers"};if(x.a(t)){if(!x.a(e)){o.a.debug("End point detected. Checking if it is closer to path start or path end...");var n=ue.distance(this.pathStart,e[0],r);ue.distance(this.pathEnd,e[0],r)>n&&(o.a.debug("Reversed path detected. Start point is closer to path end."),this.pathReversed=!0)}}else o.a.debug("Start point detected. Checking if it is closer to path start or path end..."),ue.distance(this.pathStart,t[0],r)>ue.distance(this.pathEnd,t[0],r)&&(o.a.debug("Reversed path detected. Start point is closer to path end."),this.pathReversed=!0);this.pathReversed&&(o.a.debug("Reversing points."),this.points=this.points.reverse())}},{key:"_updateCircularity",value:function(){var t=ue.distance(this.pathStart,this.pathEnd,{units:"kilometers"});(t*=1e3)<=500&&(o.a.debug("Circular path detected. Distance between path start and end points:",t.toFixed(2),"meters."),this.pathCircular=!0)}},{key:"getCount",value:function(){for(var t=this,e=0,r=function(r){var n="",i=M.a(t.points,function(t){return t.properties.index===r&&(n=t.properties.name,!0)});1!==i.length?o.a.warn("Station "+r+" found "+i.length+" times."):(o.a.debug("Station "+r+" found. Station name: "+n),e++)},n=ce;n<=fe;n++)r(n);return e}},{key:"isOrderCorrect",value:function(){for(var t=!0,e=1;e<this.points.length;e++){var r=this.points[e].properties.index,n=this.points[e-1].properties.index;o.a.debug("Point "+(e-1)),null===r?o.a.debug("Not checking order for unrecognized point: "+this.points[e].properties.name):null===n?o.a.debug("Not checking order for unrecognized point: "+this.points[e-1].properties.name):this.pathCircular&&(n===ce&&r===fe||r===ce&&n===fe)?o.a.debug("Not checking order for station",ce,"and",fe,"when route is circular."):r<=n?(o.a.warn("Detected invalid order of stations. Station "+r+" is after station "+n+"."),t=!1):o.a.debug("Station "+r+" is after station "+n+".")}return t}},{key:"areAllOnThePath",value:function(t){var e=!0;return L.a(this.points,function(r,n){var i=r.properties.index,a=r.properties.nearestOnLine.properties.dist;o.a.debug("Point "+n),null===i?o.a.debug("Not checking distance for: "+r.properties.name):a>t?(o.a.warn("Station "+i+" is too far from path. Expected maximum distance from path: "+t+" meter(s)."),e=!1):o.a.debug("Station "+i+" is on the path.")}),e}},{key:"isPathReversed",value:function(){return this.pathReversed}}]),t}(),pe=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var de=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.geoJson=e,this.lineString=B.getLineString(this.geoJson),this.points=B.getPoints(this.geoJson),this.isRouteVerifiable=!0,x.a(this.lineString)&&(o.a.error("No line string in route."),this.isRouteVerifiable=!1),x.a(this.points)&&(o.a.error("No points in route."),this.isRouteVerifiable=!1),this.isRouteVerifiable&&(this.stations=new he(this.points,this.lineString),this.path=this.stations.isPathReversed()?B.reverseLineString(this.lineString):this.lineString,this.numberOfPaths=B.getNumberOfFeatures("LineString",this.geoJson))}return pe(t,[{key:"isVerifiable",value:function(){return this.isRouteVerifiable}},{key:"isSinglePath",value:function(){var t=_.a(this.numberOfPaths,1);return t||o.a.warn("No single path defined."),o.a.debug("isSinglePath:",t,", numberOfPaths:",this.numberOfPaths),t}},{key:"areAllStationsPresent",value:function(){var t=this.stations.getCount(),e=_.a(t,14);return o.a.debug("areAllStationsPresent:",e,", numberOfStations:",t),e}},{key:"areStationsOnThePath",value:function(){var t=this.stations.areAllOnThePath(100);return o.a.debug("areStationsOnThePath:",t),t}},{key:"isStationOrderCorrect",value:function(){var t=this.stations.isOrderCorrect();return o.a.debug("isStationOrderCorrect:",t),t}},{key:"getPathLength",value:function(){var t=0,e=B.getGoogleMapsPath(this.path);return t=google.maps.geometry.spherical.computeLength(e),t/=1e3,o.a.debug("getPathLength [km]:",t),t}},{key:"fetchPathElevationData",value:function(){var t=this;return B.getPathElevations(this.path).then(function(e){return o.a.debug("Path elevations:",e),t.pathElevation=new z(e),t.pathElevation}).catch(function(t){throw new Error(t)})}},{key:"getPathElevation",value:function(){return o.a.debug("getPathElevation:",this.pathElevation),this.pathElevation}}]),t}(),ve=function(){var t=$("div#map-canvas");this.routeUrl=t.attr("data-what"),this.routeParamsUrl=t.attr("data-route-params"),this.routeApproveUrl=t.attr("data-route-approve")},ge=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var ye=function(t,e){var r="bg-green",n="bg-yellow";S.a(e)?$(t+" span.info-box-icon").removeClass([n,r].join(" ")):e?$(t+" span.info-box-icon").removeClass(n).addClass(r):$(t+" span.info-box-icon").removeClass(r).addClass(n)},me=function(t,e,r){o.a.debug("Updating control element",t,"with:",e,r),$(t+" span.info-box-number").html(e+" "+(r?"<small>"+r+"</small>":""))},be=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return ge(t,[{key:"updateRouteType",value:function(t){var e=$("input#normalRouteString").attr("value"),r=$("input#inspiredRouteString").attr("value");me("div#routeType",t?e:r)}},{key:"updatePathLength",value:function(t,e){me("div#pathLength",e.toFixed(2),"km"),ye("div#pathLength",t)}},{key:"updateElevationGain",value:function(t,e){me("div#elevationGain",e.toFixed(2),"m"),ye("div#elevationGain",t)}},{key:"updateElevationLoss",value:function(t,e){me("div#elevationLoss",e.toFixed(2),"m"),ye("div#elevationLoss",t)}},{key:"updateElevationTotalChange",value:function(t,e){me("div#elevationTotalChange",e.toFixed(2),"m"),ye("div#elevationTotalChange",t)}},{key:"updateNumberOfStations",value:function(t){ye("div#numberOfStations",t)}},{key:"updateStationsOrder",value:function(t){ye("div#stationsOrder",t)}},{key:"updateStationsOnPath",value:function(t){ye("div#stationsOnPath",t)}},{key:"updateSinglePath",value:function(t){ye("div#singlePath",t)}},{key:"updateDataConsistency",value:function(t){ye("div#dataConsistency",t)}},{key:"drawElevationChart",value:function(t){var e=parseInt(t.data.length/10),r=T.a(t.data,function(t){return t.distance.toFixed()}),n=T.a(t.data,function(t){return t.elevation});o.a.debug("Drawing elevation chart. Input:",t);new Chart($("canvas#elevationChart"),{type:"line",data:{labels:r,datasets:[{label:"",data:n,fill:"start",radius:0,backgroundColor:"rgb(32, 77, 116)"}]},options:{scales:{xAxes:[{scaleLabel:{display:!0,labelString:"[km]"},ticks:{callback:function(r,n){return n%e==0||n===t.data.length-1?r:null}}}],yAxes:[{scaleLabel:{display:!0,labelString:"[m]"}}]},legend:{display:!1},tooltips:{enabled:!1}}})}},{key:"resetElevationChart",value:function(){var t=$("canvas#elevationChart").parent();$("canvas#elevationChart").remove(),t.append('<canvas id="elevationChart"></canvas>')}},{key:"addLoaderToButton",value:function(){$("button#verifyRoute").append('<div id="loader" class="overlay"><i class="fa fa-refresh fa-spin"></i></div>')}},{key:"removeLoaderFromButton",value:function(){$("button#verifyRoute div#loader").remove()}},{key:"resetAll",value:function(t){var e=void 0===t?null:t;me("div#routeType",""),me("div#pathLength",""),ye("div#pathLength",e),me("div#elevationGain",""),ye("div#elevationGain",e),me("div#elevationLoss",""),ye("div#elevationLoss",e),me("div#elevationTotalChange",""),ye("div#elevationTotalChange",e),ye("div#numberOfStations",e),ye("div#stationsOrder",e),ye("div#stationsOnPath",e),ye("div#singlePath",e),ye("div#dataConsistency",e),this.resetElevationChart()}}]),t}(),we=40,xe=30,Ee=500;o.a.setLevel("warn"),window.setLogLevel=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"debug";return o.a.setLevel(t)},$("button#verifyRoute").bind("click",function(){if(window.google&&window.google.maps){var t=new ve,e=new be;e.resetAll(),e.addLoaderToButton(),B.getRoute(t.routeUrl).done(function(r){var n=B.getGeoJSON(r),i=new de(n);if(!i.isVerifiable())return o.a.error("Route is unverifiable."),void e.resetAll(!1);var a=i.isSinglePath();e.updateSinglePath(a);var u=i.getPathLength();e.updatePathLength(!0,u);var s=i.areAllStationsPresent();e.updateNumberOfStations(s);var c=i.isStationOrderCorrect();e.updateStationsOrder(c);var f=i.areStationsOnThePath();e.updateStationsOnPath(f),i.fetchPathElevationData().then(function(){var r=i.getPathElevation();r.enrichData(u),e.updateElevationGain(!0,r.gain);var n=u>=we||r.gain>Ee&&u>=xe;e.updateRouteType(n),e.updateElevationLoss(!0,r.loss),e.updateElevationTotalChange(!0,r.totalChange),e.drawElevationChart(r),B.getRouteParameters(t.routeParamsUrl).then(function(i){var l=u-1<=i.length&&i.length<=u+1,h=r.gain-50<=i.ascent&&i.ascent<=r.gain+50,p=i.type===(n?0:1),d=l&&h&&p;o.a.debug("isLengthConsistent:",l,", isElevationGainConsistent:",h,", isRouteTypeConsistent:",p),e.updateDataConsistency(d),a&&s&&c&&f&&d?(o.a.info("Route verification success. Approving..."),B.approveRoute(t.routeApproveUrl).then(function(){o.a.info("Route approved.");var t=$("div#pageReloadModal"),e=setTimeout(function(){window.location.reload(1)},5e3);t.on("hide.bs.modal",function(t){return clearTimeout(e)}),t.modal()}).catch(function(t){o.a.error("Route approval error.",t)})):o.a.info("Route verification failed. Cannot be approved.")}).catch(function(t){o.a.error("Route parameters data fetching error.",t)})}).catch(function(t){o.a.error("Path elevation data fetching error.",t),e.updateElevationGain(!1,0),e.updateElevationLoss(!1,0),e.updateElevationTotalChange(!1,0),e.updateDataConsistency(!1)})}).fail(function(t,e){o.a.error("Route fetching error. Status:",e)}).always(function(){e.removeLoaderFromButton()})}else o.a.error("Google Maps API is not loaded.")})}]);
//# sourceMappingURL=edk-route-verifier.min.js.map